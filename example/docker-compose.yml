# Example docker-compose.yml for running rlpx-proxy with an XDC node.
# Copy this file to the project root, create a .env file with your keys,
# and run: docker compose up -d --build

services:
  xdc-node:
    image: xinfinorg/xdposchain:v2.6.8
    expose:
      - "30303/tcp"
    ports:
      - "30303:30303/udp"
      - "8545:8545"
    environment:
      - NETWORK=mainnet
      - PRIVATE_KEY=${ACCOUNT_KEY}
      - XDC_NODEKEYHEX=${NODE_P2P_KEY}
    volumes:
      - ./xdc-data:/work/xdcchain

  rlpx-proxy:
    build: .
    ports:
      - "30303:30303/tcp"
    environment:
      - NODE_PRIVATE_KEY=${NODE_P2P_KEY}
      - UPSTREAM_HOST=xdc-node
      - UPSTREAM_PORT=30303
      - PEERS_FILE=/etc/rlpx-proxy/peers.json
      - MAX_OUTBOUND=10
    volumes:
      - ./static-nodes.json:/etc/rlpx-proxy/peers.json:ro
    depends_on:
      - xdc-node
